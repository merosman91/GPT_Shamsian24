<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ุดูุณูู - ุญุงุณุจุฉ ุงูุทุงูุฉ ุงูุดูุณูุฉ ุงููุชูุงููุฉ</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
  body {
    font-family: 'Tajawal', sans-serif;
    background: #f0f4f8;
    margin: 0;
    padding: 10px;
    color: #2c3e50;
  }
  h1, h2 {
    text-align: center;
    color: #2980b9;
  }
  .container {
    max-width: 960px;
    margin: auto;
    background: #fff;
    padding: 15px 20px 40px 20px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }
  label {
    font-weight: 700;
    margin-top: 15px;
    display: block;
  }
  select, input[type=number], input[type=text], button {
    width: 100%;
    padding: 10px;
    margin-top: 6px;
    border-radius: 6px;
    border: 1px solid #bbb;
    font-size: 16px;
    box-sizing: border-box;
  }
  button {
    background-color: #2980b9;
    color: white;
    border: none;
    font-weight: 700;
    cursor: pointer;
    margin-top: 20px;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #1c5980;
  }
  .flex-row {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }
  .flex-row > * {
    flex: 1;
    min-width: 120px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }
  th, td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: center;
    font-size: 14px;
  }
  th {
    background-color: #2980b9;
    color: white;
  }
  .icon {
    width: 24px;
    height: 24px;
    vertical-align: middle;
    margin-left: 5px;
  }
  .result-box {
    margin-top: 25px;
    background: #eaf2f8;
    padding: 15px;
    border-radius: 8px;
    line-height: 1.5;
  }
  /* Responsive */
  @media (max-width: 640px) {
    .flex-row {
      flex-direction: column;
    }
  }
  /* Tooltip style */
  .tooltip {
    position: relative;
    display: inline-block;
    cursor: help;
  }
  .tooltip .tooltiptext {
    visibility: hidden;
    width: 220px;
    background-color: #34495e;
    color: #fff;
    text-align: right;
    border-radius: 5px;
    padding: 8px;
    position: absolute;
    z-index: 1;
    top: 150%;
    right: 0;
    opacity: 0;
    transition: opacity 0.4s;
    font-size: 13px;
  }
  .tooltip:hover .tooltiptext {
    visibility: visible;
    opacity: 1;
  }
  /* Share whatsapp button */
  .whatsapp-share {
    background: #25D366;
    color: white;
    font-weight: 700;
    padding: 10px 15px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    margin-top: 15px;
    width: 100%;
  }
</style>
</head>
<body>
  <div class="container" role="main" aria-label="ุชุทุจูู ุดูุณูู ูุญุณุงุจ ุงูุทุงูุฉ ุงูุดูุณูุฉ">
    <h1>ุดูุณูู โ๏ธ</h1>
    <h2>ุญุงุณุจุฉ ุงูุทุงูุฉ ุงูุดูุณูุฉ ุงููุชูุงููุฉ</h2>

    <label for="device-select">ุงุฎุชุฑ ุงูุฌูุงุฒ ุงูููุฑุจุงุฆู <span class="tooltip">โ
      <span class="tooltiptext">ุงุฎุชุฑ ุฌูุงุฒ ูู ุงููุงุฆูุฉุ ูุน ุงููุฏุฑุฉ ุจุงููุงุช.</span>
    </span></label>
    <select id="device-select" aria-describedby="device-help" aria-required="true">
      <option value="" disabled selected>ุงุฎุชุฑ ุฌูุงุฒูุง</option>
      <option value="250" data-icon="&#127777;">ูููู ูุณูุฉ 6000 ูุญุฏุฉ (250 ูุงุช)</option>
      <option value="20" data-icon="&#128161;">ุฅูุงุฑุฉ ุฏุงุฎููุฉ (20 ูุงุช)</option>
      <option value="100" data-icon="&#128168;">ูุฑูุญุฉ (100 ูุงุช)</option>
      <option value="150" data-icon="&#127873;">ุซูุงุฌุฉ (150 ูุงุช)</option>
      <option value="200" data-icon="&#128250;">ุชููุงุฒ (200 ูุงุช)</option>
    </select>

    <div class="flex-row">
      <div>
        <label for="device-quantity">ุงูุนุฏุฏ</label>
        <input type="number" id="device-quantity" min="1" value="1" aria-required="true" />
      </div>
      <div>
        <label for="device-hours">ุณุงุนุงุช ุงูุชุดุบูู ูููููุง</label>
        <input type="number" id="device-hours" min="0.5" step="0.5" value="1" aria-required="true" />
      </div>
    </div>

    <button id="add-device-btn" aria-label="ุฅุถุงูุฉ ุงูุฌูุงุฒ ุงููุฎุชุงุฑ">โ ุฅุถุงูุฉ ุงูุฌูุงุฒ</button>

    <table aria-label="ุฌุฏูู ุงูุฃุฌูุฒุฉ ุงููุถุงูุฉ">
      <thead>
        <tr>
          <th>ุงูุฌูุงุฒ</th>
          <th>ุงููุฏุฑุฉ (ูุงุช)</th>
          <th>ุงูุนุฏุฏ</th>
          <th>ุณุงุนุงุช ุงูุชุดุบูู</th>
          <th>ุงูุงุณุชููุงู ุงููููู (ู.ู.ุณ)</th>
          <th>ุฅุฌุฑุงุกุงุช</th>
        </tr>
      </thead>
      <tbody id="device-list">
        <!-- ุงูุฃุฌูุฒุฉ ุงููุถุงูุฉ ุชุธูุฑ ููุง -->
      </tbody>
    </table>

    <h2>ุฅุนุฏุงุฏุงุช ุงููุธุงู</h2>
    <div class="flex-row">
      <div>
        <label for="sun-hours">ุณุงุนุงุช ุฐุฑูุฉ ุงูุดูุณ ุงููุนุงูุฉ</label>
        <input type="number" id="sun-hours" min="1" max="10" step="0.1" value="5" />
      </div>
      <div>
        <label for="panel-watt">ูุฏุฑุฉ ุงูููุญ ุงูุดูุณู (ูุงุช)</label>
        <select id="panel-watt" aria-required="true">
          <option value="100">100 ูุงุช</option>
          <option value="200">200 ูุงุช</option>
          <option value="300">300 ูุงุช</option>
          <option value="400" selected>400 ูุงุช</option>
          <option value="500">500 ูุงุช</option>
        </select>
      </div>
      <div>
        <label for="battery-ah">ุณุนุฉ ุงูุจุทุงุฑูุฉ (ุฃูุจูุฑ ุณุงุนุฉ)</label>
        <select id="battery-ah" aria-required="true">
          <option value="100">100 ุฃูุจูุฑ/ุณุงุนุฉ</option>
          <option value="150">150 ุฃูุจูุฑ/ุณุงุนุฉ</option>
          <option value="200" selected>200 ุฃูุจูุฑ/ุณุงุนุฉ</option>
          <option value="250">250 ุฃูุจูุฑ/ุณุงุนุฉ</option>
        </select>
      </div>
      <div>
        <label for="system-voltage">ุฌูุฏ ุงููุธุงู (ูููุช)</label>
        <select id="system-voltage" aria-required="true">
          <option value="12">12 ูููุช</option>
          <option value="24" selected>24 ูููุช</option>
          <option value="48">48 ูููุช</option>
        </select>
      </div>
    </div>

    <button id="calculate-btn" aria-label="ุญุณุงุจ ููููุงุช ุงููุธุงู">โ ุญุณุงุจ ุงููุธุงู ุงูุดูุณู</button>

    <section id="results" class="result-box" aria-live="polite" style="display:none;">
      <h2>ูุชุงุฆุฌ ุงูุญุณุงุจ</h2>
      <div id="results-content"></div>
      <button id="share-whatsapp" class="whatsapp-share" aria-label="ูุดุงุฑูุฉ ุงููุชุงุฆุฌ ุนุจุฑ ูุงุชุณุงุจ">๐ฑ ูุดุงุฑูุฉ ุนุจุฑ ูุงุชุณุงุจ</button>
    </section>

    <section id="explanation" class="result-box" style="margin-top:30px;">
      <h2>ุดุฑุญ ุงูุชูุตููุงุช ูุงูุทุงูุฉ ุงูููุฑุจุงุฆูุฉ</h2>
      <p>
        <strong>ุงูุชูุตูู ุนูู ุงูุชูุงูู:</strong> ุชูุตูู ุงูุฃุฌุฒุงุก ุงููุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู ุจุญูุซ ููุฑ ุงูุชูุงุฑ ูู ูู ุฌูุงุฒ ุนูู ุงูุชูุงูู. ูู ูุฐุง ุงูุชูุตููุ 
        <em>ุงููููุชูุฉ ุชุฒุฏุงุฏ</em> (ุชุฌูุน ุงููููุชุงุช)ุ ููู <em>ุงูุชูุงุฑ ูุธู ุซุงุจุชุงู</em>.<br>
        ูุซุงู: ููุตู ุจุทุงุฑูุชูู 12 ูููุช ุนูู ุงูุชูุงููุ ุชุตุจุญ ุงููููุชูุฉ 24 ูููุชุ ููู ุงูุชูุงุฑ ูุจูู ููุง ูู.
      </p>
      <p>
        <strong>ุงูุชูุตูู ุนูู ุงูุชูุงุฒู:</strong> ุชูุตูู ุงูุฃุฌุฒุงุก ุจุญูุซ ุชุชุตู ุฃุทุฑุงููุง ุงูููุฌุจุฉ ูุนุงู ูุงูุณุงูุจุฉ ูุนุงู. ูู ูุฐุง ุงูุชูุตููุ
        <em>ุงูุชูุงุฑ ูุฒุฏุงุฏ</em> (ุชุฌูุน ุงูุฃูุจูุฑุงุช)ุ ููู <em>ุงููููุชูุฉ ุชุธู ุซุงุจุชุฉ</em>.<br>
        ูุซุงู: ููุตู ุจุทุงุฑูุชูู 12 ูููุช 100 ุฃูุจูุฑ ุนูู ุงูุชูุงุฒูุ ูุจูู ุงููููุช 12 ูููุช ููู ุงูุชูุงุฑ ูุตุจุญ 200 ุฃูุจูุฑ.
      </p>
      <p>
        <strong>ุงููููุช (V)</strong> ูู ูุฑู ุงูุฌูุฏ ุงูููุฑุจุงุฆู ุฃู ุงูููุฉ ุงูุฏุงูุนุฉ ุงูุชู ุชุญุฑู ุงูุฅููุชุฑููุงุช.<br>
        <strong>ุงูุฃูุจูุฑ (A)</strong> ูู ููุงุณ ุงูุชูุงุฑ ุฃู ูููุฉ ุงูุดุญูุงุช ุงูููุฑุจุงุฆูุฉ ุงูุชู ุชูุฑ ูู ุฏุงุฆุฑุฉ ููุฑุจุงุฆูุฉ.<br>
        <strong>ุงููุงุช (W)</strong> ูู ุงููุฏุฑุฉ ุงูููุฑุจุงุฆูุฉุ ููุญุณุจ ุจุถุฑุจ ุงููููุช ร ุงูุฃูุจูุฑ.<br>
        ูุซุงู: ุฌูุงุฒ ูุณุชููู 100 ูุงุช ูููู ุชุดุบููู ุนูู 12 ูููุช ุจุชูุงุฑ ุญูุงูู 8.3 ุฃูุจูุฑ (100 รท 12 = 8.3).
      </p>
    </section>
  </div>

<script>
  const deviceSelect = document.getElementById('device-select');
  const deviceQuantity = document.getElementById('device-quantity');
  const deviceHours = document.getElementById('device-hours');
  const addDeviceBtn = document.getElementById('add-device-btn');
  const deviceList = document.getElementById('device-list');

  const sunHoursInput = document.getElementById('sun-hours');
  const panelWattInput = document.getElementById('panel-watt');
  const batteryAhInput = document.getElementById('battery-ah');
  const systemVoltageInput = document.getElementById('system-voltage');

  const calculateBtn = document.getElementById('calculate-btn');
  const resultsSection = document.getElementById('results');
  const resultsContent = document.getElementById('results-content');
  const shareWhatsappBtn = document.getElementById('share-whatsapp');

  let devices = [];

  function renderDeviceList() {
    deviceList.innerHTML = '';
    devices.forEach((device, idx) => {
      const dailyKwh = (device.power * device.quantity * device.hours / 1000).toFixed(2);
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${device.name}</td>
        <td>${device.power} ูุงุท</td>
        <td>${device.quantity}</td>
        <td>${device.hours}</td>
        <td>${dailyKwh}</td>
        <td>
          <button onclick="editDevice(${idx})" aria-label="ุชุนุฏูู ุฌูุงุฒ ${device.name}">โ๏ธ</button>
          <button onclick="removeDevice(${idx})" aria-label="ุญุฐู ุฌูุงุฒ ${device.name}">โ</button>
        </td>
      `;
      deviceList.appendChild(tr);
    });
  }

  function addDevice() {
    const selectedOption = deviceSelect.options[deviceSelect.selectedIndex];
    if (!selectedOption || !deviceSelect.value) {
      alert('ูุฑุฌู ุงุฎุชูุงุฑ ุฌูุงุฒ.');
      return;
    }
    const name = selectedOption.text;
    const power = parseFloat(deviceSelect.value);
    const quantity = parseInt(deviceQuantity.value);
    const hours = parseFloat(deviceHours.value);
    if (quantity < 1 || hours <= 0) {
      alert('ูุฑุฌู ุฅุฏุฎุงู ุนุฏุฏ ูุณุงุนุงุช ุชุดุบูู ุตุญูุญุฉ.');
      return;
    }
    devices.push({ name, power, quantity, hours });
    renderDeviceList();
  }

  function editDevice(idx) {
    const device = devices[idx];
    deviceSelect.value = device.power;
    deviceQuantity.value = device.quantity;
    deviceHours.value = device.hours;
    devices.splice(idx, 1);
    renderDeviceList();
  }

  function removeDevice(idx) {
    devices.splice(idx, 1);
    renderDeviceList();
  }

  function calculateSystem() {
    if (devices.length === 0) {
      alert('ูุฑุฌู ุฅุถุงูุฉ ุฌูุงุฒ ูุงุญุฏ ุนูู ุงูุฃูู.');
      return;
    }
    const sunHours = parseFloat(sunHoursInput.value);
    const panelWatt = parseInt(panelWattInput.value);
    const batteryAh = parseInt(batteryAhInput.value);
    const systemVoltage = parseInt(systemVoltageInput.value);

    // ุญุณุงุจ ุงูุงุณุชููุงู ุงููููู ุงูููู (ู.ู.ุณ)
    let totalDailyKwh = 0;
    devices.forEach(d => {
      totalDailyKwh += (d.power * d.quantity * d.hours) / 1000;
    });

    // ุญุณุงุจ ุนุฏุฏ ุงูุฃููุงุญ ุงููุทููุจุฉ (ูุน ุงูุชุฑุงุถ ููุงุกุฉ 80%)
    const panelEfficiencyFactor = 0.8;
    const totalPanelWattNeeded = totalDailyKwh * 1000 / sunHours / panelEfficiencyFactor;
    const panelCount = Math.ceil(totalPanelWattNeeded / panelWatt);

    // ุญุณุงุจ ุณุนุฉ ุงูุจุทุงุฑูุฉ ุงููุทููุจุฉ (ูุน ุงูุชุฑุงุถ 1 ููู ุงุญุชูุงุทูุ ูููุงุกุฉ 85%)
    const batteryEfficiency = 0.85;
    const batteryAhNeeded = Math.ceil((totalDailyKwh * 1000) / (systemVoltage * batteryEfficiency));

    // ุญุณุงุจ ุนุฏุฏ ุงูุจุทุงุฑูุงุช ุงููุทููุจุฉ ุจูุงุกู ุนูู ุณุนุฉ ุงูุจุทุงุฑูุฉ ุงููุฎุชุงุฑุฉ
    const batteryCount = Math.ceil(batteryAhNeeded / batteryAh);

    // ุชูุฏูุฑ ุงูุงููุฑุชุฑ (ููุณ ุงุณุชููุงู ุงูุฃุฌูุฒุฉ ูุน ูุงูุด 25%)
    const inverterWatt = Math.ceil(totalDailyKwh * 1000 * 1.25);

    // ุนุฑุถ ุงููุชุงุฆุฌ
    resultsContent.innerHTML = `
      <p>ุงูุงุณุชููุงู ุงููููู ุงูููู: <strong>${totalDailyKwh.toFixed(2)} ู.ู.ุณ</strong></p>
      <p>ุนุฏุฏ ุงูุฃููุงุญ ุงูุดูุณูุฉ ุงููุทููุจุฉ (${panelWatt} ูุงุช): <strong>${panelCount} ููุญ</strong></p>
      <p>ุณุนุฉ ุงูุจุทุงุฑูุงุช ุงููุทููุจุฉ: <strong>${batteryAhNeeded} ุฃูุจูุฑ/ุณุงุนุฉ</strong></p>
      <p>ุนุฏุฏ ุงูุจุทุงุฑูุงุช (ุณุนุฉ ${batteryAh} ุฃูุจูุฑ/ุณุงุนุฉ): <strong>${batteryCount} ุจุทุงุฑูุฉ</strong></p>
      <p>ููุฏุงุฑ ุงูุงููุฑุชุฑ ุงูููุชุฑุญ (ูุงุท): <strong>${inverterWatt} ูุงุท</strong></p>
    `;
    resultsSection.style.display = 'block';
  }

  function shareWhatsapp() {
    let message = 'ูุชุงุฆุฌ ุญุณุงุจ ููุธููุฉ ุดูุณูู ููุทุงูุฉ ุงูุดูุณูุฉ:\n';
    message += `ุงูุงุณุชููุงู ุงููููู ุงูููู: ${resultsContent.querySelector('p:nth-child(1) strong').textContent}\n`;
    message += `ุนุฏุฏ ุงูุฃููุงุญ ุงูุดูุณูุฉ ุงููุทููุจุฉ: ${resultsContent.querySelector('p:nth-child(2) strong').textContent}\n`;
    message += `ุณุนุฉ ุงูุจุทุงุฑูุงุช ุงููุทููุจุฉ: ${resultsContent.querySelector('p:nth-child(3) strong').textContent}\n`;
    message += `ุนุฏุฏ ุงูุจุทุงุฑูุงุช: ${resultsContent.querySelector('p:nth-child(4) strong').textContent}\n`;
    message += `ููุฏุงุฑ ุงูุงููุฑุชุฑ ุงูููุชุฑุญ: ${resultsContent.querySelector('p:nth-child(5) strong').textContent}\n`;
    const url = 'https://wa.me/?text=' + encodeURIComponent(message);
    window.open(url, '_blank');
  }

  addDeviceBtn.addEventListener('click', addDevice);
  calculateBtn.addEventListener('click', calculateSystem);
  shareWhatsappBtn.addEventListener('click', shareWhatsapp);
</script>
</body>
  </html>
